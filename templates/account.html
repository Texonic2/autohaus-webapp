{% extends "base.html" %}

{% block title %}Mein Konto â€“ Autohaus Heilbronn{% endblock %}

{% block content %}

<div class="konto-und-anfragen-container">

    <!-- ğŸ‘¤ Kontodaten -->
    <div class="konto-card">
        <h2 class="konto-ueberschrift"><span class="emoji">ğŸ‘¤</span> Meine Kontodaten</h2>
        <p><strong>Vorname:</strong> {{ benutzer.vorname }}</p>
        <p><strong>Nachname:</strong> {{ benutzer.nachname }}</p>
        <p><strong>E-Mail:</strong> {{ benutzer.email }}</p>
        <p><strong>Rolle:</strong> {{ benutzer.role }}</p>

        <a href="{{ url_for('passwort_aendern') }}" class="btn-passwort-aendern">
            ğŸ”‘ Passwort Ã¤ndern
        </a>
    </div>

    <!-- ğŸš— Finanzierungsanfragen -->
    <div class="finanzierungsanfrage-container">
        <h2>ğŸš— Meine Finanzierungsanfragen</h2>
        {% for anfrage in finanzierungsanfragen %}
        <div class="finanzierungsanfrage-card">
            <div class="auto-bild">
                <img src="{{ url_for('static', filename=anfrage.url) }}" alt="{{ anfrage.marke }} {{ anfrage.modell }}">
            </div>
            <div class="anfrage-details">
                <h3>{{ anfrage.marke }} {{ anfrage.modell }}</h3>
                <p><strong>Termin:</strong> {{ anfrage.Terminwunsch or 'Kein Termin angegeben' }}</p>
                <p><strong>Finanzierungsdauer:</strong> {{ anfrage.Monate }} Monate</p>
                <p><strong>Anzahlung:</strong> {{ anfrage.Anzahlung }} â‚¬</p>
                <p><strong>Monatliche Rate:</strong> {{ anfrage.Monatliche_Rate }} â‚¬</p>
                <p><strong>Schlussrate:</strong> {{ anfrage.schlussrate }} â‚¬</p>
                <p><strong>Status:</strong> <span class="status {{ anfrage.Status|lower }}">{{ anfrage.Status }}</span></p>

                <form action="{{ url_for('anfrage_loeschen', anfrage_id=anfrage.ID) }}" method="post" onsubmit="return confirm('Willst du diese Anfrage wirklich lÃ¶schen?');">
                    <button type="submit" class="btn-anfrage-loeschen">ğŸ—‘ï¸ Anfrage lÃ¶schen</button>
                </form>
            </div>
        </div>
        {% else %}
        <p>Du hast bisher keine Finanzierungsanfragen gestellt.</p>
        {% endfor %}
    </div>
    <!-- ğŸ“„ KaufvertrÃ¤ge -->
    <div class="finanzierungsanfrage-container">
        <h2>ğŸ“„ Meine KaufvertrÃ¤ge</h2>
        {% for vertrag in kaufvertraege %}
        <div class="finanzierungsanfrage-card">
            <div class="auto-bild">
                <img src="{{ url_for('static', filename=vertrag.url) }}" alt="{{ vertrag.marke }} {{ vertrag.modell }}">
            </div>
            <div class="anfrage-details">
                <h3>{{ vertrag.marke }} {{ vertrag.modell }}</h3>
                <p><strong>Erstellt am:</strong> {{ vertrag.Datum_Erstellung.strftime("%d.%m.%Y") }}</p>
                <p><strong>Adresse:</strong> {{ vertrag.kunde_adresse }}</p>
                <p><strong>Telefon:</strong> {{ vertrag.kunde_telefon }}</p>
                <p><strong>Monate:</strong> {{ vertrag.Monate }}</p>
                <p><strong>Anzahlung:</strong> {{ vertrag.Anzahlung }} â‚¬</p>
                <p><strong>Monatliche Rate:</strong> {{ vertrag.Monatliche_Rate }} â‚¬</p>
                <p><strong>Schlussrate:</strong> {{ vertrag.Schlussrate }} â‚¬</p>
                {% if vertrag.Info %}
                <p><strong>Info:</strong> {{ vertrag.Info }}</p>
                {% endif %}
            </div>
        </div>
        {% else %}
        <p>Du hast bisher keinen Kaufvertrag.</p>
        {% endfor %}
    </div>

</div>

{% endblock %}
