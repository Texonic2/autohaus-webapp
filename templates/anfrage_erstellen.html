{% extends "base.html" %}

{% block title %}ðŸ“„ Anfrage erstellen{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/anfrage_erstellen.css') }}">

<div class="anfrage-wrapper">
    <h2>ðŸ“„ Finanzierungs- oder Barkaufanfrage</h2>
    <form method="POST">


        <label class="anfrage-label">Fahrzeug auswÃ¤hlen:</label>
        <select name="auto_id" class="anfrage-input" required>
            <option value="">-- Bitte wÃ¤hlen --</option>
            {% for auto in autos %}
                <option value="{{ auto.autoid }}"
                        {% if auto_id == auto.autoid or request.form.auto_id == auto.autoid|string %}selected{% endif %}>
                    {{ auto.marke }} {{ auto.modell }} â€“ {{ '{:,.2f}'.format(auto.preis|float).replace(',', 'X').replace('.', ',').replace('X', '.') }} â‚¬
                </option>
            {% endfor %}
        </select>


        <label class="anfrage-label">Kaufart:</label>
        <select name="kaufart" class="anfrage-input" required>
            <option value="">-- Bitte wÃ¤hlen --</option>
            <option value="Barkauf" {% if kaufart == 'Barkauf' %}selected{% endif %}>Barkauf</option>
            <option value="Finanzierungsanfrage" {% if kaufart == 'Finanzierungsanfrage' %}selected{% endif %}>Finanzierung</option>
        </select>


        {% if kaufart == 'Finanzierungsanfrage' or request.form.kaufart == 'Finanzierungsanfrage' %}
            <div style="margin-top: 10px;">
                <label class="anfrage-label">Finanzierungsdauer (Monate):</label>
                <input type="number" name="laufzeit" min="1" class="anfrage-input"
                       value="{{ laufzeit or request.form.laufzeit or '' }}">

                <label class="anfrage-label">Startzahlung (â‚¬):</label>
                <input type="number" name="anzahlung" step="0.01" class="anfrage-input"
                       value="{{ anzahlung or request.form.anzahlung or '' }}">

                <label class="anfrage-label">Endzahlung (Schlussrate) (â‚¬):</label>
                <input type="number" name="schlussrate" step="0.01" class="anfrage-input"
                       value="{{ schlussrate or request.form.schlussrate or '' }}">
            </div>
        {% endif %}

        {% if rate is not none %}
            <div class="anfrage-info">
                Monatliche Rate: {{ rate }} â‚¬
            </div>
        {% endif %}


        <label class="anfrage-label">Kunden-E-Mail-Adresse:</label>
        <input type="email" name="email" class="anfrage-input"
               value="{{ request.form.email or '' }}" required>


        <label class="anfrage-label">Terminwunsch (Datum & Uhrzeit):</label>
        <input type="datetime-local" name="terminwunsch" class="anfrage-input"
               value="{{ request.form.terminwunsch or '' }}" required>

        <button type="submit" class="anfrage-button">
            {% if rate and preis %}
                âœ… Anfrage abschicken
            {% else %}
                Weiter
            {% endif %}
        </button>
    </form>
</div>
{% endblock %}
