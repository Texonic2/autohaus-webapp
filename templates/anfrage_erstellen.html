{% extends "base.html" %}

{% block title %}ðŸ“„ Anfrage erstellen{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/anfrage_erstellen.css') }}">

<div class="anfrage-wrapper">
    <h2>ðŸ“„ Finanzierungs- oder Barkaufanfrage</h2>
    <form method="POST">

        <!-- Fahrzeugauswahl -->
        <label class="anfrage-label">Fahrzeug auswÃ¤hlen:</label>
        <select name="auto_id" class="anfrage-input" required onchange="this.form.submit()">
            <option value="">-- Bitte wÃ¤hlen --</option>
            {% for auto in autos %}
                <option value="{{ auto.autoid }}"
                        {% if auto_id == auto.autoid %}selected{% endif %}>
                    {{ auto.marke }} {{ auto.modell }}
                </option>
            {% endfor %}
        </select>

        <!-- Fahrzeugpreis -->
        {% if preis %}
            <div class="anfrage-info" style="margin-top: 6px; font-weight: bold;">
                ðŸ’° Fahrzeugpreis: {{ preis | float | round(2) }} â‚¬
            </div>
        {% endif %}

        <!-- Kaufart-Auswahl -->
        <label class="anfrage-label">Kaufart:</label>
        <select name="kaufart" class="anfrage-input" required onchange="this.form.submit()">
            <option value="">-- Bitte wÃ¤hlen --</option>
            <option value="Barkauf" {% if kaufart == 'Barkauf' %}selected{% endif %}>Barkauf</option>
            <option value="Finanzierungsanfrage" {% if kaufart == 'Finanzierungsanfrage' %}selected{% endif %}>Finanzierung</option>
        </select>

        <!-- Finanzierungsfelder -->
        {% if kaufart == 'Finanzierungsanfrage' %}
            <label class="anfrage-label">Finanzierungsdauer (Monate):</label>
            <input type="number" name="laufzeit" min="1" class="anfrage-input"
                   value="{{ laufzeit or '' }}">

            <label class="anfrage-label">Startzahlung (â‚¬):</label>
            <input type="number" name="anzahlung" step="0.01" class="anfrage-input"
                   value="{{ anzahlung or '' }}">

            <label class="anfrage-label">Endzahlung (Schlussrate) (â‚¬):</label>
            <input type="number" name="schlussrate" step="0.01" class="anfrage-input"
                   value="{{ schlussrate or '' }}">
        {% endif %}

        <!-- Monatliche Rate -->
        {% if rate is not none %}
            <div class="anfrage-info">
                ðŸ“† Monatliche Rate: {{ rate }} â‚¬
            </div>
        {% endif %}

        <!-- E-Mail -->
        <label class="anfrage-label">Kunden-E-Mail-Adresse:</label>
        <input type="email" name="email" class="anfrage-input"
               value="{{ request.form.email or '' }}" required>

        <!-- Termin -->
        <label class="anfrage-label">Terminwunsch (Datum & Uhrzeit):</label>
        <input type="datetime-local" name="terminwunsch" class="anfrage-input"
               value="{{ request.form.terminwunsch or '' }}" required>

        <!-- Fehlermeldung -->
        {% if fehler %}
            <p class="anfrage-error">{{ fehler }}</p>
        {% endif %}

        <!-- Submit-Button -->
        <button type="submit" class="anfrage-button">
            {% if rate is not none or kaufart == 'Barkauf' %}
                âœ… Anfrage abschicken
            {% else %}
                Weiter
            {% endif %}
        </button>
    </form>
</div>
{% endblock %}
