{% extends "base.html" %}

{% block head %}
    <link rel="icon" href="{{ url_for('static', filename='nova.png') }}" type="image/x-icon">
{% endblock %}

{% block title %}Startseite â€“ Autohaus Heilbronn{% endblock %}

{% block content %}

<section class="finanz-section">
    <div class="finanz-container">
      <h1 class="finanz-title">ğŸ’¶ Finanzierung berechnen</h1>
      <p class="finanz-sub">Effektiver Jahreszins: <strong>2â€¯%</strong> â€“ fair & transparent</p>

  <form method="post" class="finanz-form">

    <!-- Versteckte Aktion, wird per JS geÃ¤ndert -->
    <input type="hidden" name="aktion" id="aktion" value="">

    <div class="finanz-row">
      <input type="number" name="fahrzeugpreis" placeholder="Fahrzeugpreis (â‚¬)" required
       value="{{ fahrzeugpreis if fahrzeugpreis else fahrzeug.preis }}">


      <input type="number" name="anzahlung" placeholder="Anzahlung (â‚¬)" required
             value="">
    </div>

    <div class="finanz-row">
      <input type="number" name="laufzeit" placeholder="Laufzeit (Monate)" required
             value="">
      <input type="number" name="schlussrate" placeholder="Schlussrate (â‚¬ â€“ optional)"
             value="">
    </div>

    <!-- Verstecktes Feld fÃ¼r die berechnete Rate -->
    <input type="hidden" name="rate" id="rate" value="{{ rate if rate else '' }}">

    <button type="submit" onclick="document.getElementById('aktion').value='berechnen';" class="finanz-button">ğŸ§® Monatsrate berechnen</button>
    <button type="submit" onclick="document.getElementById('aktion').value='barzahlung';" class="finanz-button">Direkte Barzahlung</button>

    {% if rate %}
    <div class="finanz-ergebnis-box">
      <div class="finanz-result">
        <span class="finanz-label">Monatliche Rate:</span>
        <span class="finanz-value">{{ rate }}â€¯â‚¬</span>
      </div>

      <div class="finanz-summary">
        <h3>Ihr Wunschfahrzeug im Ãœberblick</h3>
        <ul>
          <li><strong>Fahrzeug:</strong> {{ fahrzeug.marke }} {{ fahrzeug.modell }}</li>
          <li><strong>Leistung:</strong> {{ fahrzeug.leistung }} PS</li>
          <li><strong>Fahrzeugpreis:</strong> {{ fahrzeugpreis }}â€¯â‚¬</li>
          <li><strong>Anzahlung:</strong> {{ anzahlung }}â€¯â‚¬</li>
          <li><strong>Laufzeit:</strong> {{ laufzeit }} Monate</li>
          {% if schlussrate %}
          <li><strong>Schlussrate:</strong> {{ schlussrate }}â€¯â‚¬</li>
          {% endif %}
          <li>Bei einer Laufzeit von <strong>{{ laufzeit }}</strong> Monaten betrÃ¤gt Ihre monatliche Rate <strong>{{ rate }}â€¯â‚¬</strong>.</li>
        </ul>
      </div>

      <!-- Checkbox fÃ¼r Anzeige des Terminbereichs -->
      <input type="checkbox" id="termin-toggle" class="termin-toggle">
      <label for="termin-toggle" class="finanz-button-secondary">Jetzt Termin vereinbaren</label>

      <div class="termin-box">
        <h3>ğŸ—“ï¸ Termin vereinbaren</h3>

          <div class="termin-row">
            <label for="termin">GewÃ¼nschtes Datum:</label>
            <input type="date" id="termin" name="termin" required>
          </div>
          <div class="termin-row">
            <label for="uhrzeit">GewÃ¼nschte Uhrzeit:</label>
            <input type="time" id="uhrzeit" name="uhrzeit" required>
          </div>

          <button type="submit" onclick="document.getElementById('aktion').value='termin';" class="finanz-button">Termin anfragen</button>

      </div>
    </div>
    {% endif %}

  </form>
</section>

<div class="legal-content">
    <span class="legal-text">(c) 2023 - NOvA Drive GmbH</span> |
    <a href="#">Impressum</a> |
    <a href="#">Datenschutz</a>
</div>

<script>
  // Optional: Wenn du die Rate mit JS berechnest, dann hier den Wert in #rate setzen.
  // Beispiel (wenn nÃ¶tig):
  // function setRateValue(rate) {
  //   document.getElementById('rate').value = rate;
  // }
</script>

{% endblock %}
